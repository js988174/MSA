# SpringCloud로 개발하는 마이크로서비스 애플리케이션(MSA)

# MSA란?
* 마이크로서비스(microservice)는 애플리케이션을 느슨하게 결합된 서비스의 모임으로 구조화하는 *서비스 지향 아키텍처(SOA) 스타일의 일종인 소프트웨어 개발 기법이다.

## MSA의 장점

* 각각의 서비스는 모듈화가 되어있으며 이러한 모듈까리는 RPC 또는 message-driven API등을 이용하여 통신한다. 이러한 MSA는 각각 개별의 서비스 개발을 빠르게 하며, 유지보수도 쉽게할 수  있도록 한다. 
팀 단위로 적절한 수준에서 기술 스택을 다르게 가져갈 수 있다. 회사가 java의 spring 기반이라도 MSA를 적용하면 node.js로 블록체인 개발 모듈을 연동함에 무리가 없다. 
마이크로서비스는 서비스별로 독립적 배포가 가능하다. 따라서 지속적인 배포 CD도 모놀로식에 비해서 가볍게 할 수 있다.
마이크로서비스는 각각 서비스의 부하에 따라 개별적으로 scale-out이 가능하다. 메모리, CPU적으로 상당부분 이득이 된다.
 

## MSA의 단점

* MSA는 모놀리식에 비해 상대적으로 많이 복잡하다. 서비스가 모두 분산되어 있기 때문에 개발자는 내부 시스템의 통신을 어떻게 가져가야 할지 정해야한다. 또한, 통신의 장애와 서버의 부하 등이 있을 경우 어떻게 transaction을 유지할지 결정하고 구현해야한다. 
모놀리식에서는 단일 트랜잭션을 유지하면 됐지만 MSA에서는 비즈니스에 대한 DB를 가지고 있는 서비스도 각기 다르고, 서비스의 연결을 위해서는 통신이 포함되기 때문에 트랜잭션을 유지하는게 어렵다. 
통합 테스트가 어렵다. 개발 환경과 실제 운영환경을 동일하게 가져가는 것이 쉽지 않다. 
실제 운영환경에 대해서 배포하는 것이 쉽지 않다. 마이크로서비스의 경우 서비스 1개를 재배포 한다고 하면 다른 서비스들과의 연계가 정상적으로 이루어지고 있는지도 확인해야한다. 

# Cloud Native Acrhitecture
* **확장 가능한 아키텍처**
  * 시스템의 수평적 확정에 유연
  * 확장된 서버로 시스템의 부하 분산, 가용성 보장
  * 시스템 또는, 서비스 애플리케이션 단위의 패키지
  * 모니터링

* **탄력적 아미텍처**
  * 서비스 생성 - 통합 - 배포, 비즈니스 환경 변화에 대응 시간 단축
  * 분활 된 서비스 구조
  * 무상태 통신 프로토콜
  * 서비스의 추가와 삭제 자동으로 감지
  * 변경된 서비스 요청에 따라 사용자 요청 처리

* **장애 격리**
  * 특정 서비스에 오류가 발생해도 다른 서비스에 영향 주지 않음

# Cloud Native Application
* **지속적인 통합, CI**
  * ex) Jenkins, Team CI, Travis CI
  * 통합 서버, 소스 관리, 빌드 도구, 테스트 도구

* **지속적 배포**
  * Pipe line
  * Continuous Delivery

  
# Factors(https://12factor.net/) 
<img src="https://user-images.githubusercontent.com/76925402/230910833-f3a5a0cb-736e-4b7a-a78c-24f7ff6aba54.png">


# Monolith vs MSA
* Monolith: 하나의 서비스 또는 애플리케이션이 **하나의 거대한** 아키텍쳐를 가질 때
* MSA: 애플리케이션을 느슨하게 결합된 **서비스의 모임으로** 구조화하는 서비스 지향 아키텍처(SOA) 스타일의 일종인 소프트웨어 개발 기법

<img src="https://user-images.githubusercontent.com/76925402/230914245-50074fc8-c05e-44f1-bf2d-563ed20f63da.png">


# API Gateway Service
* 어떤 규모에서든 개발자가 API를 손쉽게 생성, 게시, 유지 관리, 모니터링 및 보안 유지할 수 있도록 하는 완전관리형 서비스

## 기능
* 인증 및 권한 부여
* 서비스 검색 통합
* 응답 캐싱
* 속도 제한
* 부하 분산
* 로깅, 추적, 상관 관계
* 헤더, 쿼리 문자열 및 청구 변환
* IP 허용 목록에 추가

# Spring Cloud Config
* 분산 시스템에서 서버 클라이언트 구성에 필요한 설정 정보를 외부 시스템에서 관리
* 하나의 중앙화 된 저장소에서 구성요소 관리 기능
* 각 서비스를 다시 빌드하지 않고, 바로 적응 가능
* 애플리케이션 배포 파이프라인을 통해 DEV-UAT-PROD 환경에 맞는 구성 정보 사용


